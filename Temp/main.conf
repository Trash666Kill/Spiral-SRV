###############################################
# DNSMASQ MAIN CONFIGURATION - SRV17517
###############################################

# Endereço onde o serviço escuta
listen-address=10.0.10.254

# Domínio local
domain=srv17517.local

###############################################
#  SEPARAÇÃO DE VM/CT POR PREFIXO DE MAC
###############################################

# VMs KVM/QEMU → MAC prefixo 52:54:00 → Tag EVEN → IPs pares
dhcp-host=52:54:00:*,set:EVEN

# Containers LXC → MAC prefixo 00:16:3e → Tag ODD → IPs ímpares
dhcp-host=00:16:3e:*,set:ODD

###############################################
#  DHCP RANGE 10.0.10.0/24 (pares/ímpares)
###############################################

# Range para IPs PARES (EVEN) — começa em endereço par
dhcp-range=set:EVEN,10.0.10.2,10.0.10.248,12h

# Range para IPs ÍMPARES (ODD) — começa em endereço ímpar
dhcp-range=set:ODD,10.0.10.3,10.0.10.249,12h

###############################################
#  DHCP OPTIONS (Gateway, DNS, NTP)
#  Aplica igualmente a EVEN e ODD
###############################################

# Gateway
dhcp-option=tag:EVEN,3,10.0.10.254
dhcp-option=tag:ODD,3,10.0.10.254

# DNS local
dhcp-option=tag:EVEN,6,10.0.10.254
dhcp-option=tag:ODD,6,10.0.10.254

# NTP
dhcp-option=tag:EVEN,42,10.0.6.1
dhcp-option=tag:ODD,42,10.0.6.1

###############################################
#  DNS CONFIG (originais)
###############################################

# Upstream DNS para domínio externo específico
server=/sugisawa.local.br/172.30.100.6

expand-hosts
no-hosts
domain-needed
bogus-priv
dnssec
dhcp-sequential-ip
cache-size=1024

# Arquivos adicionais
conf-file=/usr/share/dnsmasq-base/trust-anchors.conf
resolv-file=/etc/dnsmasq.d/config/resolv
addn-hosts=/etc/dnsmasq.d/config/hosts

# Arquivo de reservas (MAC → IP fixo)
dhcp-hostsfile=/etc/dnsmasq.d/config/reservations